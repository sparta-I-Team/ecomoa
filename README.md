<div align="center">

# 🌱 EcoMoa (에코모아)

![프로젝트 배너](https://github.com/user-attachments/assets/de0eb8f4-361b-4714-80a5-7a226a9c2f1a)

### 🌍 더 나은 내일을 위한 우리의 작은 실천, 에코모아와 함께하세요

</div>

<br>
<br>

## 🌟 프로젝트 소개

> *"기후 위기는 더 이상 먼 미래의 이야기가 아닙니다."*

우리는 기후 변화의 심각성을 직접 체감하고 있습니다.<br>

지난해 연평균 기온이 산업화 이전보다 약 1.45℃ 상승하며 역사상 가장 더운 해를 기록했고,<br>
해수 온도 상승, 빙하 및 해빙의 녹는 속도가 증가하였습니다. <br>
보고서에서 이러한 현상은 전지구적 온실가스 감축 노력이 부족했다는 증거이며,<br> 
적극적인 온실가스 감축 노력을 강화해야한다고 경고합니다.<br>

에코모아는 이러한 환경 문제에 대한 해결책을 제시하고자 탄생했습니다. <br>
일상 속 작은 실천들을 통해 환경 보호에 동참해보세요!

**참조된 글 - https://www.greenpeace.org/korea/update/30698/blog-ce-act-now-for-climate-disaster**


<br>
<br>

## 👥 팀원 소개

### Frontend Developers
<table>
<tr>
<td align="center" width="25%">
<a href="https://github.com/JongHoJang">
<img src="https://github.com/JongHoJang.png" width="120" style="border-radius: 50%;"/></a>
<br><br>
<b>장종호</b><br>
Team Lead<br>
📊 탄소계산기<br>
jangjh9414@gmail.com<br><br>
</td>
<td align="center" width="25%">
<a href="https://github.com/RYC0208">
<img src="https://github.com/RYC0208.png" width="120" style="border-radius: 50%;"/></a>
<br><br>
<b>노용철</b><br>
Deputy Lead<br>
🌿 챌린지<br>
🗺️ 지도<br>
ryc0208@naver.com<br><br>
</td>
<td align="center" width="25%">
<a href="https://github.com/Jaeheeyu20240612">
<img src="https://github.com/Jaeheeyu20240612.png" width="120" style="border-radius: 50%;"/></a>
<br><br>
<b>유재희</b><br>
Member<br>
🔐 로그인/회원가입<br>
🏠 홈<br>
bsjaehee94@gmail.com<br>
<br>
</td>
<td align="center" width="25%">
<a href="https://github.com/BlossomS2">
<img src="https://github.com/BlossomS2.png" width="120" style="border-radius: 50%;"/></a>
<br><br>
<b>장수인</b><br>
Member<br>
👥 커뮤니티<br>
rose970515@naver.com<br><br>
</td>
</tr>
</table>

### Design
<table>
<tr>
<td align="center" width="50%">
<b>이지솔</b><br>
🎨 UI/UX Design<br>
홈/챌린지/지도
</td>
<td align="center" width="50%">
<b>나영은</b><br>
🎨 UI/UX Design<br>
계산기/커뮤니티
</td>
</tr>
</table>


<br>
<br>

## 🛠️ 기술 스택

[![Next.js](https://img.shields.io/badge/Next.js-000000?style=for-the-badge&logo=next.js&logoColor=white)](https://nextjs.org)
[![TypeScript](https://img.shields.io/badge/TypeScript-3178C6?style=for-the-badge&logo=typescript&logoColor=white)](https://www.typescriptlang.org)
[![Tailwind CSS](https://img.shields.io/badge/Tailwind-38B2AC?style=for-the-badge&logo=tailwind-css&logoColor=white)](https://tailwindcss.com)
[![React Query](https://img.shields.io/badge/React_Query-FF4154?style=for-the-badge&logo=react-query&logoColor=white)](https://tanstack.com/query/latest)
[![Chart.js](https://img.shields.io/badge/Chart.js-FF6384?style=for-the-badge&logo=chart.js&logoColor=white)](https://www.chartjs.org/)
[![Zustand](https://img.shields.io/badge/Zustand-333333?style=for-the-badge&logo=react&logoColor=white)](https://zustand-demo.pmnd.rs/)
[![AOS](https://img.shields.io/badge/AOS-F7DF1E?style=for-the-badge&logo=javascript&logoColor=black)](https://michalsnik.github.io/aos/)
[![Supabase](https://img.shields.io/badge/Supabase-3ECF8E?style=for-the-badge&logo=supabase&logoColor=white)](https://supabase.io)
[![Vercel](https://img.shields.io/badge/Vercel-000000?style=for-the-badge&logo=vercel&logoColor=white)](https://vercel.com)

### 기술적 의사결정

| 분류 | 기술 | 채택 이유 |
|------|------|-----------|
| **Framework** | Next.js | - 서버 사이드 렌더링 지원<br>- 빠른 페이지 로드<br>- SEO 최적화 |
| **언어** | TypeScript | - 타입 안정성 확보<br>- 개발 생산성 향상<br>- 버그 사전 방지 |
| **CSS Framework** | Tailwind CSS | - 빠르고 일관된 스타일링<br>- 개발 시간 단축<br>- 높은 커스터마이징 자유도 |
| **클라이언트 상태** | Zustand | - 간편한 클라이언트 상태 관리<br>- 작은 번들 사이즈<br>- 직관적인 API |
| **서버 상태** | TanStack Query | - 효율적인 데이터 fetching<br>- 강력한 캐싱 기능<br>- 서버 상태 최적화 |
| **차트** | Chart.js | - 유연한 차트 커스터마이징<br>- 다양한 차트 타입 제공<br>- 성능 최적화 |
| **애니메이션** | AOS | - 손쉬운 스크롤 애니메이션<br>- 다양한 효과 제공<br>- 가벼운 라이브러리 |
| **배포** | Vercel | - Next.js 최적화 배포<br>- 간편한 CI/CD<br>- 안정적인 성능 |
| **지도** | Kakao Maps SDK | - 높은 데이터 정확도<br>- 풍부한 API 문서<br>- 안정적인 서비스 |
| **공공 데이터** | 스마트서울맵 API | - 서울시 친환경 가게 정보<br>- 제로웨이스트샵 위치 데이터<br>- 실시간 데이터 업데이트 |
| **데이터베이스** | Supabase | - 서버리스 아키텍처<br>- 실시간 DB 기능<br>- Postgres 기반의 안정성 |
| **폼 관리** | React Hook Form | - 간편한 폼 상태 관리<br>- 효율적인 유효성 검사<br>- 최적화된 성능 |
| **유효성 검사** | Zod | - TypeScript 친화적<br>- Hook Form 연동 용이<br>- 강력한 스키마 검증 |

## 💫 페이지 소개 및 주요 기능 
<br>
<br>

### 🏠 메인페이지
<div align="center">
<table>
<tr>
<td align="center" width="50%">

![메인 소개](https://github.com/user-attachments/assets/1447ee5c-2f7e-42d9-8736-62d61d33d232)

</td>
<td align="center" width="50%">

![메인 소개 2](https://github.com/user-attachments/assets/710faff1-a44d-43d8-8ed4-b524b6e18420)

</td>
</tr>
<tr>
<td align="center" width="50%">

![메인 소개 3](https://github.com/user-attachments/assets/bf223819-96f3-4e4e-91a1-a0f7a8e07d0e)

</td>
<td align="center" width="50%">

![메인 소개4](https://github.com/user-attachments/assets/8c5eb2a6-5bd1-436c-b3b5-30ccadabd7dc)

</td>
</tr>
</table>
</div>

메인페이지에서는 제공되는 서비스를 빠르게 알아 볼 수 있도록 소개하는 페이지입니다.<br>
aos 라이브러리를 사용하여 애니메이션 효과를 더욱 효율적으로 나타냈습니다.<br>

<hr>
<br>
<br>

### 🔑 로그인/회원가입

<div align="center">
<table>
<tr>
<td align="center" width="50%">

![로그인 페이지](https://github.com/user-attachments/assets/f0c795ce-9da8-42f6-a356-72c2b4e2d063)

</td>
<td align="center" width="50%">
  
![로그인 모바일](https://github.com/user-attachments/assets/bbf04da0-4d07-4207-bb8f-39a6d77db0a6)
  
</td>
</table>
</div>




**소셜 로그인**


- 이메일 로그인, 회원가입이 가능
- 네이버, 구글, 카카오 소셜 로그인이 가능 
- 최초 로그인 시 닉네임 설정 모달이 제공

소셜 로그인을 구현할 때, 구글과 카카오는 supabase의 프로바이더이기때문에 `signInWithOAuth` 메서드를 사용해서 쉽게 구현할 수 있었다.<br>
그런데 네이버 로그인은 supabase에서 공식적으로 지원이되지 않아 별도로 구현이 필요했다.

1. 네이버 개발자 웹에서 간편 로그인 후 콜백 URL 설정

2. 콜백주소에서 code를 가져와 네이버 로그인 api를 사용해서 토큰을 발급 받고, 토큰을 이용해 naver에서 사용자 데이터를 가져왔음.

```typescript
const code = searchParams.get("code");
const accessToken = await getNaverAccessToken(code);

if (!accessToken) {
  return NextResponse.redirect(
    new URL("/login?error=failed_to_authenticate", req.url)
  );
}

const userData = await fetchUserDataFromNaver(accessToken);
if (!userData) {
  return NextResponse.redirect(
    new URL("/login?error=failed_to_fetch_user_data", req.url)
  );
}
```

3. 가져온 정보를 이용해 이미 가입되어있는지 확인하고, 가입되어있지않으면 supabase의 signUp 메서드를 이용해 가입 후, signInWithPassword로 로그인되도록 구현

```typescript
const { error: signUpError } = await supabase.auth.signUp({
  email: userData.email,
  password: "temporary-password" // 임시 비밀번호
});

const { error: loginError } = await supabase.auth.signInWithPassword({
  email: userData.email,
  password: "temporary-password"
});
```


<hr>
<br>
<br>

### 👤 마이페이지

<div align="center">
<table>
<tr>
<td align="center" width="50%">

![마이페이지](https://github.com/user-attachments/assets/1005b7a7-f5e5-4b7a-96e8-129d76dfbb56)

</td>
<td align="center" width="50%">
  
![마이페이지 모바일](https://github.com/user-attachments/assets/b06aa8fb-3177-44c9-94df-88261bb26be3)
  
</td>
</table>
</div>

각 페이지에서 제공하는 컴포넌트를 마이페이지에서 재사용하여 개인 로그를 볼 수 있도록 구현했습니다.

<hr>
<br>
<br>

### 🌿 데일리 챌린지
<div align="center">
<table>
<tr>
<td align="center" width="50%">

![데일리챌린지](https://github.com/user-attachments/assets/aba56a4d-8b55-4338-967e-bf38cfdd92a3)

</td>
<td align="center" width="50%">
  
![데일리 챌린지 모바일](https://github.com/user-attachments/assets/e9eadd58-0a4a-4375-81f2-4a19e6ceac30)
  
</td>
</table>
</div>


### 1. 레벨링 시스템

데일리 챌린지 참여를 통해 획득하는 포인트로 성장하는 레벨링 시스템입니다.<br>
챌린지 달성, 인증 등 다양한 활동을 통해 포인트를 모아 레벨을 올릴 수 있습니다.

```typescript
// 레벨별 설정
export const LEVEL_CONFIG = {
  1: { /* 레벨 1 설정 */ },
  2: { /* 레벨 2 설정 */ },
  3: { /* 레벨 3 설정 */ },
  4: { /* 레벨 4 설정 */ },
} as const;

// 레벨 계산 함수
export const calculateLevelInfo = (totalPoints: number): LevelInfo => {
  for (const [level, config] of Object.entries(LEVEL_CONFIG)) {
    if (totalPoints >= config.min && totalPoints < config.max) {
      const currentPoints = totalPoints - config.min;
      const levelRange = config.max - config.min;
      const pointsToNextLevel = config.max - totalPoints;
      
      return { level: Number(level), name: config.name, ... };
    }
  }
  return { /* 최대 레벨 정보 */ };
};
```

#### 작동 방식

1. **레벨 범위 확인**
   - `Object.entries()`로 레벨 설정을 순회
   - totalPoints가 해당 레벨의 범위(min ≤ totalPoints < max)에 있는지 확인합니다.

2. **레벨 정보 계산**
   - 현재 레벨에 속한 점수(currentPoints)는 totalPoints - config.min으로 계산합니다
   - 레벨 범위(maxPoints)는 config.max - config.min입니다
   - 다음 레벨까지 필요한 점수(pointsToNextLevel)는 config.max - totalPoints로 계산됩니다.
   - 
3. **레벨 정보 반환**
   - 해당 레벨의 설정과 계산된 정보를 LevelInfo 타입으로 반환합니다.
  
4. **최대 레벨 처리**
   - totalPoints가 최대 레벨(4)의 범위를 초과하면 레벨 4의 정보를 반환하며, 추가 경험치는 고정됩니다.




### 2. **캘린더**
캘린더 시스템은 사용자가 날짜를 선택하거나 월별로 일정을 확인할 수 있도록 돕는 기능입니다.<br>
해당 기능 설명은 길어져서 노션으로 공유했습니다. <br>

https://empty-bottle-ec4.notion.site/fda2239a05b04306ac5552815ae0219c

<hr>
<br>
<br>

### 📊 탄소 계산기

<div align="center">
<table>
<tr>
<td align="center" width="50%">

![계산기](https://github.com/user-attachments/assets/2b49728c-e59b-4d8d-b19e-736a99edabb9)

</td>
<td align="center" width="50%">
  
![계산기 모바일](https://github.com/user-attachments/assets/0d394c1a-d2af-4a10-9f29-da60649cb1ef)

</td>
</table>
</div>



- **설명할 기능 제목**
```typescript
//코드 예시
```
<hr>
<br>
<br>

### 🗺️ 친환경 지도
![친환경 지도](https://github.com/user-attachments/assets/a60d08d1-e574-4867-893f-1bd2bc5488c6)

### 지도 검색어 디바운싱

사용자 경험 개선을 위해 검색어 입력 시 즉시 검색하지 않고, 입력이 끝난 후 검색을 수행하는 디바운싱을 구현했습니다.

```typescript
// 검색어 상태 관리
const [searchTerm, setSearchTerm] = useState("");
const [debouncedSearchTerm, setDebouncedSearchTerm] = useState("");

// 디바운싱 구현
useEffect(() => {
  const timer = setTimeout(() => {
    setDebouncedSearchTerm(searchTerm);
  }, 300);

  return () => {
    clearTimeout(timer);
  };
}, [searchTerm]);

// 검색 필터링 로직
const filteredStores = stores.filter(
  (store) =>
    store.store_name.toLowerCase().includes(debouncedSearchTerm.toLowerCase()) ||
    store.road_address.toLowerCase().includes(debouncedSearchTerm.toLowerCase())
);
```

#### 작동 방식
1. 사용자가 검색어 입력 시 `searchTerm` 상태 업데이트
2. 300ms 동안 추가 입력이 없으면 `debouncedSearchTerm` 업데이트
3. 최종 검색어로 가게 목록 필터링

이를 통해 불필요한 렌더링을 방지하고 검색 성능을 최적화했습니다.

### 카카오맵 동적 로드 구현

애플리케이션의 초기 로딩 성능 최적화를 위해 Kakao Maps SDK를 동적으로 로드하는 방식을 채택했습니다.

```typescript
useEffect(() => {
  const script = document.createElement("script");
  script.src = `//dapi.kakao.com/v2/maps/sdk.js?appkey=${process.env.NEXT_PUBLIC_KAKAO_APP_JS_KEY}&autoload=false`;
  script.async = true;

  script.onload = () => {
    window.kakao.maps.load(() => setIsMapLoaded(true));
  };

  document.head.appendChild(script);
}, []);
```

1. `createElement("script")`로 새로운 script 태그를 생성합니다.

2. `script.src`에서 `autoload=false` 옵션으로 SDK를 불러옵니다. 이는 스크립트 로드 시 자동으로 카카오맵을 초기화하지 않도록 하는 설정입니다.

3. `script.async = true`를 통해 스크립트를 비동기적으로 로드하여 페이지 로딩을 차단하지 않습니다.

4. `script.onload` 이벤트 핸들러에서 `window.kakao.maps.load()` 메서드를 호출하여 수동으로 카카오맵을 초기화합니다.

5. `setIsMapLoaded(true)`로 지도 로드 상태를 관리하여, 지도가 완전히 로드된 후에만 마커나 인포윈도우 등의 기능을 사용할 수 있도록 합니다.

이러한 방식으로 구현하면 페이지 초기 로딩 성능을 최적화하고, <br>
지도 로드 상태에 따른 UI 처리를 효과적으로 할 수 있었습니다. <br>
지도 로드가 완료된 후에는 마커, 인포윈도우, 줌 컨트롤 등 다양한 기능을 구현하였습니다.  <br>

<hr>
<br>
<br>

### 👥 커뮤니티

<div align="center">
<table>
<tr>
<td align="center" width="33%">

![커뮤니티](https://github.com/user-attachments/assets/8599da6c-f96d-4e61-b4b5-a1e22b4c8711)

</td>
<td align="center" width="33%">

![챌린지 인증](https://github.com/user-attachments/assets/363138a1-e6a8-4d38-a959-2b9421647ffd)
</td>
<td align="center" width="33%">

![아나바다](https://github.com/user-attachments/assets/0ccb7189-da1c-4c47-8c07-860cd4b80d31)

</td>
</tr>
</table>
</div>

서버와의 비동기 데이터 요청 및 상태 관리를 더 쉽게 할 수 있도록 React Query를 사용했고 <br>
자동 데이터 캐싱과 백그라운드 데이터 동기화로 사용자 경험을 향상시키며 서버 상태 관리를 쉽게 처리하고, <br>
로딩 상태와 에러 상태를 관리할 수 있다보니 useGetChallenge와 같은 custom hook을 이용하여 챌린지 데이터를 쉽게 가져오고, <br>
로딩 및 에러 상태를 관리했고 데이터의 캐싱을 통해 반복적인 서버 요청을 줄이고 성능 최적화를 진행했습니다 <br>

## 🚧 트러블 슈팅

### 1. 
**문제**
- 문제1

**해결**
```typescript
```

### 2. 
**문제**
- 문제1

**해결**
```typescript

```

---

<div align="center">
